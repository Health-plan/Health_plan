<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="layout/testBasic">
	<th:block layout:fragment="title">
		<title>테스트 페이지입니다.</title>
	</th:block>
	
	<body>
	<th:block layout:fragment="contents">
		<div class="title">
			<h4 class="main_title fw-bold mb-4 d-inline-block">게시글 관리</h4>
			<h5 class="sub_title d-inline-block">문의사항</h5>
			
			<label for="sort" class="float-end fs-6">정렬기준
				<select class="form-select-sm" id="sort" aria-label=".form-select-sm example" onchange="">
					<option value="" disabled selected>정렬</option>
					<option value="2">최신순</option>
					<option value="1">오래된순</option>
					<option value="0">답변대기중</option>
					

				</select>
			</label>
		</div>

		<div class="table-responsive clearfix">
			<table class="table table-hover text-center">
				<thead>
					<tr class="table_title">
						<th>번호</th>
						<th>제목</th>
						<th>분류</th>
						<th>작성자</th>
						<th>답변여부</th>
						<th>작성일자</th>
					</tr>
				</thead>
				<tbody id="listTest">
					<tr th:if="${not #lists.isEmpty(postList)}"
						th:each="row : ${postList}">
						<td scope="row" th:text="${row.postId}"></td>
						<td><a
							th:href="main.do<!--/*@{/adminQuestionDetail.do( idx=${row.postId} )*/-->"
							th:text="${row.title}"></a></td>
						<td th:if="${row.boardSubType.equals(0)}">건의사항</td>
						<td th:text="${row.mbrId}"></td>
	
						<td th:if="${row.answerState.equals(0)}">답변대기중</td>
						<td th:unless="${row.answerState.equals(0)}">답변 완료</td>
						<td th:text="${row.postDate}"></td>
					</tr>
					<tr th:unless="${not #lists.isEmpty( postList )}">
						<td colspan="6">조회된 결과가 없습니다.</td>
					</tr>
				</tbody>
			</table>
		</div>

		<div class="page_navigation">
			<th:block layout:fragment="paging">
				<nav th:replace="fragments/common :: pagination"></nav>
			</th:block>
		</div>

		<th:block layout:fragment="script">
			<script th:inline="javascript">
				
				//query string pasing 하는 메소드
				function getQueryStringObject(){
					var a = window.location.search.substr(1).split('&');
					if(a == "") return {};
					var b = {};
					for(var i=0; i<a.length; ++i){
						var p = a[i].split('=',2);
						if(p.length == 1)
							b[p[0]]="";
						else
							b[p[0]] = decodeURIComponent(p[1].replace(/\+/g," "));
					}
					return b;
				}
				
				//sortType값(queryString에서 가져옴)
				var qs = getQueryStringObject();
				var sortType = qs.sortType
				
				//sortType 기본값 설정
				if(sortType == null){
					sortType = 2;
				}
				//select값 유지
				document.getElementById("sort").value=sortType;
				
				
				/*select value*/
				$("#sort").change(function(){
					selectVal = $(this).val();
					$(document).ready(function(){
						//select값이 있을때(option 선택 시) 페이지 이동
						if($("#sort").val() != null){
							location.href = "getBoard.do?currentPageNo=1&recordsPerPage=10&pageSize=10&sortType=" + selectVal;
						}
					})
				})
				
				//페이징 uri 설정
				/*<![CDATA[*/
				function movePage(uri, queryString){
					if(sortType == null)
						location.href = uri + queryString;
					else
						location.href = uri + queryString + '&sortType=' + sortType;
				}
				/*]]>*/
				
			</script>
		</th:block>
	</th:block>
	</body>
</html>