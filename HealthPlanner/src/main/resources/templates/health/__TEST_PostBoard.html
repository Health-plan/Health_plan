<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="layout/basic">
	<th:block layout:fragment="title">
		<title>테스트 페이지입니다.</title>
	</th:block>
	
	<body>
	<th:block layout:fragment="contents">
		<div class="title">
			<h4 class="main_title fw-bold mb-4 d-inline-block">게시글 관리</h4>
			<h5 class="sub_title d-inline-block">문의사항</h5>
			
			<label for="sort" class="float-end fs-6">정렬기준
				<select class="form-select-sm" id="sort" name="sort" aria-label=".form-select-sm example" onchange="sortSelect()">
					<option value="2" selected disabled>정렬</option>
					<option value="2">최신순</option>
					<option value="1">오래된순</option>
					<option value="0">답변대기중</option>					
				</select>
			</label>
		</div>
		
		<div id="listTest">
			<div class="table-responsive clearfix">
				<table class="table table-hover text-center">
					<thead>
						<tr class="table_title bg-light">
							<th>번호</th>
							<th>제목</th>
							<th>분류</th>
							<th>작성자</th>
							<th>답변여부</th>
							<th>작성일자</th>
						</tr>
					</thead>
					<tbody>
						<tr th:if="${not #lists.isEmpty(postList)}"
							th:each="row : ${postList}">
							<td scope="row" th:text="${row.postId}"></td>
							<td><a
								th:href="@{BoardDetail.do(postId=${row.postId})}"
								th:text="${row.title}"></a></td>
							<td th:if="${row.boardSubType.equals(0)}">건의사항</td>
							<td th:text="${row.mbrId}"></td>
		
							<td th:if="${row.answerState.equals(0)}">답변대기중</td>
							<td th:unless="${row.answerState.equals(0)}">답변 완료</td>
							<td th:text="${row.postDate}"></td>
						</tr>
						<tr th:unless="${not #lists.isEmpty( postList )}">
							<td colspan="6">조회된 결과가 없습니다.</td>
						</tr>
					</tbody>
				</table>
			</div>
	
			<div class="page_navigation">
				<th:block layout:fragment="paging">
					<nav th:replace="fragments/common_post :: pagination"></nav>
				</th:block>
			</div>
		</div>

		<th:block layout:fragment="script">
			<script th:inline="javascript">
				var selectVal;
				
				//select box 선택 시 변경
				function sortSelect(){
					selectVal=$("#sort").val();
					var Criteria = {
						sortType:selectVal
					};
					$.ajax({
						url: "postSort.do",
						data: Criteria,
						type: "POST",
						success:function(data){
							console.log("성공");
						}
					}).done(function(fragment){
						$("#listTest").replaceWith(fragment);
					});
				}
				
				
				//페이징버튼 클릭 시
				/*<![CDATA[*/
				function movePage(PageNo){
					var Critera = {
						currentPageNo:PageNo,
						sortType:selectVal
					};
					$.ajax({
						url:"postSort.do",
						data: Critera,
						type: "POST"
					}).done(function(fragment){
						$("#listTest").replaceWith(fragment);
					})	
				}
				/*]]>*/
				
			</script>

		</th:block>
	</th:block>
	</body>
</html>